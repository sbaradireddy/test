LEFT JOIN (
    SELECT 
        T_POL_PTY_DIM_HST.INSD_PTY_PK AS INSD_PTY_PK,
        T_POL_PTY_DIM_HST.SRC_PTY_ID AS SRC_PTY_ID,
        T_POL_PTY_DIM_HST.NAM_FST AS NAM_FST,
        T_POL_PTY_DIM_HST.NAM_LST AS NAM_LST,
        T_POL_PTY_DIM_HST.NAM_MDL AS NAM_MDL,
        T_POL_PTY_DIM_HST.NAM_SFX AS NAM_SFX,
        T_POL_PTY_DIM_HST.PMRY_NAMD_INSD_FLG AS PMRY_NAMD_INSD_FLG,
        T_POL_PTY_DIM_HST.NAMD_INSD_FLG AS NAMD_INSD_FLG,
        T_POL_PTY_DIM_HST.DRVR_FLG AS DRVR_FLG,
        T_POL_PTY_DIM_HST.DRVR_LIC_NUM AS DRVR_LIC_NUM,
        T_POL_PTY_DIM_HST.DRVR_LIC_STATE AS DRVR_LIC_STATE,
        T_POL_PTY_DIM_HST.POL_PK AS POL_PK,
        ROW_NUMBER() OVER (PARTITION BY POL_PK ORDER BY POL_PK) AS rn
    FROM 
        CDWQA.DWADMN.T_POL_PTY_DIM_HST
    QUALIFY rn = 1
) LKP_ALT_LIC_NUM
ON LKP_ALT_LIC_NUM.POL_PK = SQ_S10_NJ_DMV_EXTRACT.POL_PK

LEFT JOIN (
    SELECT 
        NCIC_VAL,
        VEH_MAKE_CD,
        ROW_NUMBER() OVER (PARTITION BY VEH_MAKE_CD ORDER BY VEH_MAKE_CD) AS rn
    FROM 
        CDWQA.DWADMN.NCIC_CODES_XREF
    QUALIFY rn = 1
) LKP_NCIC_VEH_MAKE_CODE
ON LKP_NCIC_VEH_MAKE_CODE.VEH_MAKE_CD = SQ_S10_NJ_DMV_EXTRACT.MK
