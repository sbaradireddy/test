WITH SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT_temp as ( 
 -- writting query for Source_qualifier override query 
SELECT VPSPF.POL_STAT_PREM_PK, 
VPSPF.POL_STAT_UNIT_PK, 
VPSPF.POL_STAT_PK,
VPSPF.POL_PK, 
VPSPF.CVG_PK, 
VPSPF.PCAT_UNIT_PK, 
VPSPF.LCTN_PK,
VPSPF.ORIG_CVG_PK, 
VPSPF.ORIG_POL_PK,
VPSPF.POL_STATE_VRSN, 
VPSPF.POL_STATE_EFF_DT, 
VPSPF.SRC_POL_ID, 
VPSPF.POL_NUM,
VPSPF.POL_SEQ_NUM,
VPSUDH.UNIT_TYPE, 
VPSDH.ORIG_POL_STATE_VRSN, 
VPSDH.STAT_TRAN_CODE, 
VPSDH.OOS_TRANS_F,
VPSDH.REAPPLY_TRANS_F, 
VPSDH.BACKOUT_TRANS_F, 
VPSPF.SRC_RISK_UNIT_ID,
VPSPF.SRC_STAT_PREMIUM_ID, 
VPSPF.SRC_STAT_UNIT_ID,
VPSPF.SRC_STAT_HEADER_ID,
VPSPF.SRC_CVG_ID,
VPSPF.STATE_CODE,
VPSPF.PREMIUM_SOURCE_C,
VPSPF.PREMIUM_SOURCE_T,
VPSPF.PREMIUM_SOURCE_SEQ,
VPSPF.CLASS_CODE,
VPSPF.TERRITORY_ID, 
VPSPF.PREM_COVERAGE_M,
VPSPF.LIMIT_AMT1,
VPSPF.LIMIT_VAL_TYP_ID1, 
VPSPF.LIMIT_AMT2, 
VPSPF.LIMIT_VAL_TYP_ID2, 
VPSPF.LIMIT_AMT3,
VPSPF.LIMIT_VAL_TYP_ID3,
VPSPF.DED_AMT1, 
VPSPF.DED_VAL_TYP_ID1,
VPSPF.DED_AMT2, 
VPSPF.DED_VAL_TYP_ID2,
VPSPF.DED_AMT3, 
VPSPF.DED_VAL_TYP_ID3, 
VPSPF.PREM_WRIT_M,
VPSPF.CNTRB_TO_PREMIUM_F,
VPSPF.RCD_ACTN_TYP,
VPSPF.DATA_DT, 
VPSPF.PRCSG_GRP_CD, 
VPSPF.POL_STATE_STAT,
VPSPF.CO_ID,
VPSPF.PROD_ID,
VPSPF.CORP_CD,
VPSPF.CO_CD, 
VPSPF.SRC_PROD_ID, 
VPSPF.SRC_CD, 
VPSPF.RCD_TYP, 
VPSPF.PROD_CD,
VPCF.ACCTG_DT, 
VCD.SRC_CORP_ID, 
VCD.SRC_CO_ID,
VCD.CORP_NAM,
VCD.CO_NAM,
VPD.LOB_CD,
VPD.LOB_NAM,
VPD.PROD_NAM,
VPCDDH.RISK_UNIT_VAL,
VPCDDH.RISK_UNIT_CSTRN_TYP,
VPCDDH.RISK_UNIT_NUM_FMLYS,
VPCDDH.RISK_UNIT_CONDO_FLG, 
VPCDDH.RISK_UNIT_HEAT_TYP, 
VPCDDH.RISK_UNIT_YR_OF_CSTRN, 
VPCDDH.RISK_UNIT_LEAD_XCLSN_FLG, 
VPCDDH.RISK_UNIT_DELEADED_FLG, 
VPCDDH.RISK_UNIT_CERTFD_LEAD_FREE_FLG,
VPCDDH.PTCTV_DVC_BRGLR_ALM_TYP, 
VPCDDH.PTCTV_DVC_FIRE_ALM_TYP, 
VPCDDH.PTCTV_DVC_SPRNKLR_TYP, 
VPCDDH.BUS_CLAS, 
VPCDDH.DAYCARE_NUM_OF_PRSNS, 
VPCDDH.EARTHQK_ZONE, 
VPCDDH.EARTHQK_MSNRY_FLG, 
VPCDDH.NAMD_STORM_BUYDOWN_OPT,
VPCDDH.NAMD_STORM_DDCTBL_OPT,
VPCDDH.FUEL_LBLTY_PMRY_LCTN_NUM_A_TNK,
VPCDDH.FUEL_LBLTY_LCTN_1_NUM_A_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_2_NUM_A_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_3_NUM_A_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_4_NUM_A_TNKS, 
VPCDDH.FUEL_LBLTY_PMRY_LCTN_NUM_B_TNK,
VPCDDH.FUEL_LBLTY_LCTN_1_NUM_B_TNKS,
VPCDDH.FUEL_LBLTY_LCTN_2_NUM_B_TNKS,
VPCDDH.FUEL_LBLTY_LCTN_3_NUM_B_TNKS,
VPCDDH.FUEL_LBLTY_LCTN_4_NUM_B_TNKS,
VPCDDH.FUEL_LBLTY_PMRY_LCTN_NUM_C_TNK,
VPCDDH.FUEL_LBLTY_LCTN_1_NUM_C_TNKS,
VPCDDH.FUEL_LBLTY_LCTN_2_NUM_C_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_3_NUM_C_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_4_NUM_C_TNKS, 
VPCDDH.FUEL_LBLTY_PMRY_LCTN_NUM_D_TNK,
VPCDDH.FUEL_LBLTY_LCTN_1_NUM_D_TNKS,
VPCDDH.FUEL_LBLTY_LCTN_2_NUM_D_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_3_NUM_D_TNKS, 
VPCDDH.FUEL_LBLTY_LCTN_4_NUM_D_TNKS, 
VPCDDH.BOAT_LEN,
VPCDDH.BOAT_MOTR_HP, 
VPCDDH.WTRCRFT_LEN, 
VPCDDH.WTRCRFT_MOTR_HP, 
VPCDDH.WTRCRFT_NAVGN_FRM, 
VPCDDH.WTRCRFT_NAVGN_TO, 
VPCDDH.WTRCRFT_SPD, 
VPCDDH.WTRCRFT_TYP,
VPCDDH.MOTORIZED_LAND_CNVYC_TYP,
VPCDDH.MOTORIZED_LAND_CNVYC_SPD, 
VPCDDH.SNOWMOBILE_YR, 
VPCDDH.SNOWMOBILE_ENGN_CC, 
VPCDDH.WRKRS_COMP_NUM_OF_INSVNTS,
VPCDDH.WRKRS_COMP_NUM_OF_OUTSVNTS,
VPDHC.CUR_TERM_EFF_DT, 
VPDHC.CUR_TERM_XPTN_DT, 
VPLUDH.TERRTY_CD, 
VPLUDH.BOSTON_DIST, 
VPLUDH.FIRE_DIST, 
VPLUDH.THOU_FT_FRM_HDRNT_FLG,
VPLUDH.FIVE_MILES_FRM_FIRE_DEPT_FLG,
VPLUDH.FIRE_PTCTN_CLAS, 
VPLUDH.MILES_FRM_WTR,
VPLUDH.WTR_DSTNC_CD, 
VPLUDH.STORM_SHUTTER_FLG, 
VPLUDH.LEAD_PAINT_FLG, 
VPLUDH.STRCT_TYP, 
VPLUDH.SQ_FT, 
VPLUDH.YR_BLT, 
VPLUDH.YR_PRCHD,
VPLUDH.MKT_VAL,
VPLUDH.SCNDY_HME_FLG, 
VPLUDH.PMRY_HME_INSD_FLG,
VPLUDH.CSTRN_TYP, 
VPLUDH.NUM_OF_FMLYS,
VPLUDH.NUM_IN_FIRE_DIV,
VPLUDH.ROOF_TYP,
VPLUDH.HEATG_SYS,
VPLUDH.HEATG_SYS_FUEL_TYP,
VPSDH.SRC_DATA_SET_NBR, 
VPDHC.PRI_ADDR_PSTL_CD, 
VPCDDH.ADDL_RSDNC_CT, 
VPCDDH.VEH_CT,
VPCDDH.INEXP_OPER_CT,
VPCDDH.UNINSD_MTRST_CVG_FLG,
VPCDDH.ADDL_RSDNC_CVG_FLG,
VPCDDH.ADDL_RSDNC_HO2470_CVG_FLG,
VPCDDH.BUS_PURST_CT, 
VPCDDH.RV_CT AS RV_CT0,
VPCDDH.UNLIC_RV_CT, 
VPCDDH.RNTL_CT, 
VPCDDH.SAILBOAT_25_CT, 
VPCDDH.SAILBOAT_35_CT, 
VPCDDH.PWRBOAT_15_50_CT, 
VPCDDH.PWRBOAT_15_100_CT, 
VPCDDH.PWRBOAT_15_150_CT, 
VPCDDH.PWRBOAT_26_50_CT, 
VPCDDH.PWRBOAT_26_100_CT, 
VPCDDH.PWRBOAT_26_150_CT, 
VPCDDH.PWRBOAT_26_225_CT, 
VPCDDH.BLNKT_CVG_FLG, 
VPCDDH.EARTHQK_ZONE2, 
VPCDDH.LOC_OIL_TANK, 
VPCDDH.WTRCRFT_LEN_C, 
VPCDDH.WTRCRFT_MOTR_HRSPWR, 
VPCDDH.LOC_OIL_TANK2, 
VPCDDH.LOC_OIL_TANK3, 
VPCDDH.LOC_OIL_TANK4, 
VPCDDH.LOC_OIL_TANK5, 
VPCDDH.LOC_OIL_TANK6, 
VPCDDH.INCDTL_OCPNY_CT, 
VPLUDH.WTR_DSTNC_FLG, 
VPLUDH.SQ_FT_SRC, 
VPLUDH.HSE_STYL, 
VPLUDH.HSE_STYL_SRC, 
VPLUDH.NUM_OF_ACRES, 
VPLUDH.PRCHS_PRC, 
VPLUDH.RPLMT_CST, 
VPLUDH.NMD_STORM_AMT,
VPLUDH.DWLG_USE_OCPNY, 
VPLUDH.OWNR_OCPYD_FLG,
VPLUDH.SALE_VCNT_RNTD_FLG,
VPLUDH.BUS_ACTVTYS_FLG,
VPLUDH.DAY_CARE_FLG,
VPLUDH.SPCL_CSTRN_FLG,
VPLUDH.NUM_OF_RSDNTS, 
VPLUDH.HME_PSTL_CD, 
VPLUDH.HME_NUM_UNITS, 
VPLUDH.HME_UNDLYG_LMT,
VPPUDH.UNDLYG_POL_CD, 
VPPUDH.UNDLYG_AUTO_POL_CO,
VPPUDH.UNDLYG_AUTO_POL_NUM,
VPPUDH.ADDL_VEH_CT,
VPCDDH.INCDTL_OFC_PRMSES_CD,
VPCDDH.INCDTL_OFC_OTHR_THAN_INSD_CD,
VPCDDH.PTCTV_DVC_CERT_FLG, 
VPCDDH.PTCTV_DVC_PCT_DSCNT, 
VPCDDH.RISK_UNIT_BUS_USE_FLG, 
VPCDDH.RISK_UNIT_PSTL_CD, 
VPCDDH.BUS_PURST_PRMM,
VPLUDH.COML_ZONEG_FLG, 
VPLUDH.NUM_OF_STORIES,
VPLUDH.HME_PRI_PROP_FLG,
VPLUDH.HME_RNTL_PROP_FLG, 
VPPUDH.AUTO_POL_CRDT, 
VPPUDH.YTHFL_OPER_SRCHG_FLG,
VPPUDH.YTHFL_OPER_SRCHG, 
VPPUDH.ADDL_PPTY_CT, 
VPPUDH.PPTY_POL_CRDT, 
VPPUDH.UNDLYG_WTRCRFT_POL_CO,
VPPUDH.WTRCRFT_CT, 
VPPUDH.ATTACH_PT,
VPPUDH.INSD_INCORP_FLG, 
VPPUDH.RV_CT, 
VPPUDH.ASSIST_LVNG_FLG, 
VPPUDH.AT_FLT_FLG, 
VPPUDH.CLERICAL_EMPLOYEE_FLG, 
VPPUDH.INCDNTL_OCC_FLG, 
VPPUDH.HM_OFFICE_FLG, 
VPPUDH.POOL_FLG, 
VPPUDH.HM_SRVCS_FLG, 
VPPUDH.SPA_FLG,
VPPUDH.TCHR_FLG, 
VPPUDH.TRUST_FLG,
VPPUDH.UNDLYG_AUTO_POL_LMT, 
VPPUDH.UNDLYG_PPTY_POL_LMT, 
VPPUDH.PI_LIAB_CVG_FLG, 
VPPUDH.YTHFL_OPER_SRCHG_CT, 
VPLUDH.PSTL_CD, 
VPCDDH.BOAT_USG, 
VPCDDH.BOAT_EQPT, 
VPLUDH.BCEG, 
VPLUDH.ROOF_AGE, 
VPLUDH.YR_ROOF_INST, 
VPLUDH.POOL_CD, 
VPLUDH.TRMP_FLG 
FROM
CDWQA.dwadmn.v_pol_cvg_fact VPCF,
CDWQA.dwadmn.v_prod_dim VPD ,
CDWQA.dwadmn.v_co_dim VCD,
CDWQA.dwadmn.v_pol_stat_dim_hst VPSDH ,
CDWQA.dwadmn.v_pol_dim_hst_core VPDHC ,
CDWQA.dwadmn.v_pol_stat_prem_fact VPSPF,
CDWQA.dwadmn.v_pol_cvg_dtls_dim_hst VPCDDH,
CDWQA.dwadmn.v_pol_stat_unit_dim_hst VPSUDH ,
CDWQA.dwadmn.v_pol_lctn_unit_dim_hst VPLUDH ,
CDWQA.dwadmn.v_pol_pcat_unit_dim_hst VPPUDH ,

  CDWQA.dwadmn.v_pol_stat_dim_hst LEFT OUTER JOIN CDWQA.dwadmn.v_pol_dim_hst_core ON (CDWQA.dwadmn.v_pol_stat_dim_hst.ORIG_POL_PK=CDWQA.dwadmn.v_pol_dim_hst_core.POL_PK) ,
  CDWQA.dwadmn.v_pol_stat_prem_fact LEFT OUTER JOIN CDWQA.dwadmn.v_pol_cvg_dtls_dim_hst ON (CDWQA.dwadmn.v_pol_stat_prem_fact.ORIG_CVG_PK=CDWQA.dwadmn.v_pol_cvg_dtls_dim_hst.CVG_PK) ,
 CDWQA.dwadmn.v_pol_stat_unit_dim_hst  LEFT OUTER JOIN CDWQA.dwadmn.v_pol_lctn_unit_dim_hst ON (CDWQA.dwadmn.v_pol_stat_unit_dim_hst .ORIG_LCTN_PK=CDWQA.dwadmn.v_pol_lctn_unit_dim_hst.LCTN_PK)
  LEFT OUTER JOIN CDWQA.dwadmn.v_pol_pcat_unit_dim_hst ON (CDWQA.dwadmn.v_pol_stat_unit_dim_hst .ORIG_PCAT_UNIT_PK=CDWQA.dwadmn.v_pol_pcat_unit_dim_hst.PCAT_UNIT_PK)
  WHERE 
  (
  VPCF.CVG_PK=VPSPF.CVG_PK AND
 VPSPF.POL_STAT_UNIT_PK=VPSUDH.POL_STAT_UNIT_PK AND
  VPSUDH.POL_STAT_PK=V_POL_STAT_DIM_HST.POL_STAT_PK AND
  VPCF.CO_ID=VCD.CO_ID AND VPCF.PROD_ID=VPD.PROD_ID
  )  AND
 (VPCF.PRCSG_GRP_CD='NE' AND
 RTRIM(LTRIM(VPCF.CO_CD )) IN ('BHIC', 'MWAC', 'PRAC','BHICC','BHPIC','BHSIC','BHPFIC') AND
 RTRIM(LTRIM(VPCF.PROD_CD)) IN ('HO', 'PCAT','DF') AND
 RTRIM(LTRIM(VPCF.CORP_CD)) ='PRC' AND
 VPCF.ACCTG_DT <= '2024-09-30' AND
 VPCF.ACCTG_DT >= '2024-07-01' AND 
 RTRIM(LTRIM(VPSPF.PREMIUM_SOURCE_T)) <> 'MISC' AND
 VPSPF.CNTRB_TO_PREMIUM_F='Y' AND
 VPSPF.RCD_ACTN_TYP<>'D')
ORDER BY
 VPSPF.SRC_POL_ID,
 VPSPF.SRC_RISK_UNIT_ID,
 VPSPF.POL_STATE_VRSN,
 V_POL_STAT_DIM_HST.SRC_DATA_SET_NBR,
 VPSPF.PREMIUM_SOURCE_C
 )
 select * from SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT_temp limit 5
