EXPTRANS as (
        -- writting query for expression function
SELECT EXPTRANS2.source_record_id,
              -- NEXTVAL --(Use the sequence created in snowflake)
-- AS S10_ISO_PLOTA_EXTRACT_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_STAT_PREM_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_STAT_UNIT_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_STAT_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CVG_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PCAT_UNIT_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LCTN_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ORIG_CVG_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ORIG_POL_PK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_STATE_VRSN,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_STATE_EFF_DT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_POL_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_NUM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_SEQ_NUM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_RISK_UNIT_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_STAT_PREMIUM_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_STAT_UNIT_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_STAT_HEADER_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_CVG_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.STATE_CODE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_XPTN_DT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PRI_ADDR_PSTL_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNIT_TYPE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_DATA_SET_NBR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ORIG_POL_STATE_VRSN,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.STAT_TRAN_CODE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.OOS_TRANS_F,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.REAPPLY_TRANS_F,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BACKOUT_TRANS_F,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PREMIUM_SOURCE_C,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PREMIUM_SOURCE_T,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PREMIUM_SOURCE_SEQ,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CLASS_CODE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.TERRITORY_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PREM_COVERAGE_M,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LIMIT_AMT1,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LIMIT_VAL_TYP_ID1,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LIMIT_AMT2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LIMIT_VAL_TYP_ID2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LIMIT_AMT3,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LIMIT_VAL_TYP_ID3,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DED_AMT1,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DED_VAL_TYP_ID1,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DED_AMT2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DED_VAL_TYP_ID2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DED_AMT3,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DED_VAL_TYP_ID3,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PREM_WRIT_M,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CNTRB_TO_PREMIUM_F,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RCD_ACTN_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DATA_DT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PRCSG_GRP_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POL_STATE_STAT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CO_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CO_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CO_NAM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_CO_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CORP_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CORP_NAM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_CORP_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PROD_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PROD_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PROD_NAM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_PROD_ID,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOB_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOB_NAM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RCD_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SRC_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_1_DESC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_1_AMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_2_DESC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_2_AMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_3_DESC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_3_AMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DDCTBL_1_DESC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DDCTBL_1_AMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DDCTBL_2_DESC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DDCTBL_2_AMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BUS_PPTY_INCRSD_LMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_BCL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_BOAT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_BOAT_EQPT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_BOAT_MOTR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_BOAT_TRLR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_CAMERA,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_COINS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_ELTRNCS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_ELTRNCS_OFF_PRMSES,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_ELTRNCS_ON_PRMSES,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_ELTRNCS_IN_VEH,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_ELTRNCS_OUT_VEH,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FINE_ART,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FINE_ART_EXCLDG_BRKAGE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FINE_ART_INCLG_BRKAGE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FINE_ART_DRBL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FINE_ART_FRAGILE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FINE_ART_PPR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_FURS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_GOLF,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_GOLF_CART,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_GUNS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_JEWELERY,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_JEWELERY_IN_VALT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_JEWELERY_NO_VALT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_MONEY,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_MUSICL_INSTMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_MUSICL_INSTMT_NON_PFSNL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_MUSICL_INSTMT_PFSNL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_OTHR_STRCT_1,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_OTHR_STRCT_2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_OTHR_STRCT_3,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_OTHR_STRCT_4,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_BLDG_ADDNS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_SCRTYS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_SLVRW,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LMT_STAMPS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ACCTG_DT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_VAL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_PSTL_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_CSTRN_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_NUM_FMLYS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_CONDO_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_HEAT_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_YR_OF_CSTRN,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_LEAD_XCLSN_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_DELEADED_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_CERTFD_LEAD_FREE_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PTCTV_DVC_BRGLR_ALM_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PTCTV_DVC_FIRE_ALM_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PTCTV_DVC_SPRNKLR_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PTCTV_DVC_CERT_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PTCTV_DVC_PCT_DSCNT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RISK_UNIT_BUS_USE_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BUS_CLAS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DAYCARE_NUM_OF_PRSNS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.INCDTL_OFC_PRMSES_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.INCDTL_OFC_OTHR_THAN_INSD_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.EARTHQK_ZONE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.EARTHQK_MSNRY_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NAMD_STORM_BUYDOWN_OPT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NAMD_STORM_DDCTBL_OPT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_PMRY_LCTN_NUM_A_TNK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_1_NUM_A_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_2_NUM_A_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_3_NUM_A_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_4_NUM_A_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_PMRY_LCTN_NUM_B_TNK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_1_NUM_B_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_2_NUM_B_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_3_NUM_B_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_4_NUM_B_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_PMRY_LCTN_NUM_C_TNK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_1_NUM_C_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_2_NUM_C_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_3_NUM_C_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_4_NUM_C_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_PMRY_LCTN_NUM_D_TNK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_1_NUM_D_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_2_NUM_D_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_3_NUM_D_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FUEL_LBLTY_LCTN_4_NUM_D_TNKS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BOAT_LEN,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BOAT_MOTR_HP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_LEN,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_MOTR_HP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_NAVGN_FRM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_NAVGN_TO,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_SPD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.MOTORIZED_LAND_CNVYC_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.MOTORIZED_LAND_CNVYC_SPD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SNOWMOBILE_YR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SNOWMOBILE_ENGN_CC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WRKRS_COMP_NUM_OF_INSVNTS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WRKRS_COMP_NUM_OF_OUTSVNTS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ADDL_RSDNC_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.VEH_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.INCDTL_OCPNY_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.INEXP_OPER_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNINSD_MTRST_CVG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ADDL_RSDNC_CVG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ADDL_RSDNC_HO2470_CVG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BUS_PURST_CT,
               --SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RV_CT AS RV_CT_UMB_COV,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNLIC_RV_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RNTL_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SAILBOAT_25_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SAILBOAT_35_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_15_50_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_15_100_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_15_150_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_26_50_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_26_100_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_26_150_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PWRBOAT_26_225_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BLNKT_CVG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.EARTHQK_ZONE2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOC_OIL_TANK,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_LEN_C ,--AS WTRCRFT_LEN_C,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_MOTR_HRSPWR, -- AS WTRCRFT_MOTR_HRSPWR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOC_OIL_TANK2,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOC_OIL_TANK3,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOC_OIL_TANK4,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOC_OIL_TANK5,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LOC_OIL_TANK6,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BUS_PURST_PRMM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.TERRTY_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BOSTON_DIST,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FIRE_DIST,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.THOU_FT_FRM_HDRNT_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FIVE_MILES_FRM_FIRE_DEPT_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.FIRE_PTCTN_CLAS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.MILES_FRM_WTR,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTR_DSTNC_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTR_DSTNC_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.STORM_SHUTTER_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.LEAD_PAINT_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.COML_ZONEG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.STRCT_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NUM_OF_STORIES,
               NULL AS NUM_OF_STORIES_SRC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SQ_FT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SQ_FT_SRC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HSE_STYL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HSE_STYL_SRC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NUM_OF_ACRES,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.YR_BLT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.YR_PRCHD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PRCHS_PRC,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.MKT_VAL,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RPLMT_CST,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NMD_STORM_AMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DWLG_USE_OCPNY,-- AS DWLG_USE_OCPNY,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.OWNR_OCPYD_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SALE_VCNT_RNTD_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BUS_ACTVTYS_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.DAY_CARE_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SCNDY_HME_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PMRY_HME_INSD_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CSTRN_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SPCL_CSTRN_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NUM_OF_FMLYS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NUM_IN_FIRE_DIV,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.NUM_OF_RSDNTS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ROOF_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HEATG_SYS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HEATG_SYS_FUEL_TYP,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HME_PSTL_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HME_NUM_UNITS,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HME_PRI_PROP_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HME_RNTL_PROP_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HME_UNDLYG_LMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNDLYG_POL_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNDLYG_AUTO_POL_CO,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNDLYG_AUTO_POL_NUM,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ADDL_VEH_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.AUTO_POL_CRDT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.YTHFL_OPER_SRCHG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.YTHFL_OPER_SRCHG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.YTHFL_OPER_SRCHG_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ADDL_PPTY_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PPTY_POL_CRDT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNDLYG_WTRCRFT_POL_CO,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.WTRCRFT_CT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ATTACH_PT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.INSD_INCORP_FLG,
              -- SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.RV_CT1 AS RV_CT_UMB_PRODUCT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ASSIST_LVNG_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.AT_FLT_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CLERICAL_EMPLOYEE_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.INCDNTL_OCC_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HM_OFFICE_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POOL_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.HM_SRVCS_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.SPA_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.TCHR_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.TRUST_FLG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNDLYG_AUTO_POL_LMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.UNDLYG_PPTY_POL_LMT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PI_LIAB_CVG_FLG,
               NULL AS UMB_OTHR_EFF_DT,
               NULL AS UMB_OTHR_LMT,
               NULL AS UMB_OTHR_LMT_2,
               NULL AS UMB_PSTL_CD,
               NULL AS UMB_NUM_OF_FMLYS,
               NULL AS UMB_VEH_TYP_CD,
               NULL AS UMB_OPER_DOB,
               NULL AS UMB_VEH_OWNRSP_STAT,
               NULL AS AUTO_UNDLYG_LMT,
               NULL AS RV_TYP,
               NULL AS WTRCRFT_BOAT_TYP,
               NULL AS WTRCRFT_LNGTH,
               NULL AS WTRCRFT_ENGINE_SIZE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BCEG,
               EXPTRANS2.INCDT_COUNT AS LOSS_HISTORY_COUNT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.PSTL_CD,
               NULL AS ISO_PER_LIN_STA_PLN_SUBLIN_CD,
               NULL AS ISO_EXCEPTION_CODE,
               NULL AS ISO_ORD_OR_LAW_COV_CODE,
               NULL AS ISO_STATUS_CODE,
               NULL AS ISO_WIND_DEDUCTIBLE_SIZE_CODE,
               NULL AS ISO_MOLD_COVERAGE_CODE,
               NULL AS ISO_BUILDING_AND_CONTENTS_CODE,
               NULL AS ISO_WINDTORM_HAIL_COV_IND_CD,
               NULL AS ISO_LOSS_SETTLE_IND_CODE,
               NULL AS ISO_CLASSIFICATION_CODE,
               NULL AS ISO_ENV_IMP_COV_CODE,
               NULL AS ISO_UMB_ATTACH_HO_PL,
               NULL AS ISO_UMB_ATTACH_PERS_AUTO,
               NULL AS ISO_UMB_UNDERLY_HO_PL_INDIC,
               NULL AS ISO_UMB_UNDERLY_AUTO_INDIC,
               NULL AS ISO_UMB_RISK_PROFILE,
               NULL AS ISO_LIMIT_OF_LIAB_CODE,
               NULL AS ISO_UMB_UNINS_UNDERINS_LLC,
               NULL AS ISO_UMB_SELF_INS_RETENTION,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BOAT_USG,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.BOAT_EQPT,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.ROOF_AGE,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.YR_ROOF_INST,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.POOL_CD,
               SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.TRMP_FLG,
               REGEXP_REPLACE(           '{{START_DT}}',CHR(39),null,1,0,'c'           ) AS V_BATCH_START_DT,
REGEXP_REPLACE(   '{{END_DT}}',CHR(39),null,1,0,'c'    ) AS V_BATCH_END_DT,
               REGEXP_REPLACE(           '{{START_DT}}',CHR(39),null,1,0,'c'           ) AS V_RPRTG_PERIOD_START_DT,
REGEXP_REPLACE(   '{{END_DT}}',CHR(39),null,1,0,'c'    ) AS V_RPRTG_PERIOD_END_DT,
               IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) = 'BUILD_ORD' AND RTRIM(LTRIM(UNIT_TYPE)) = 'DP_3', 'XX', IFF(RTRIM(LTRIM(PROD_CD)) = 'PCAT', 'PL', IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) IN('EQUAKE','LOS_ASMEQ','LOS_ASMEQC'), 'EQ', IFF(RTRIM(LTRIM(PROD_CD)) = 'DF', 'DF', IFF(SUBSTR(PREMIUM_SOURCE_C,1,5) IN( 'COVC_', 'OUT_M'), 'IM', IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) IN( 'BUS_PUR', 'BUS_PUR_C', 'DAY_CARE', 'FARM_LIAB', 'FARM_LIABC', 'INC_OCP_OC', 'INC_OCP_OR', 'INC_OCPNCY', 'MTRZD_LANC', 'MTRZD_LAND', 'OCPNCY_RES', 'OTHR_LOC_C', 'OTHR_LOC_P', 'OWN_SW', 'OWN_SW_C', 'PCAT_LIAB', 'PI', 'RES_REN_C', 'RES_REN_P', 'UMB', 'WATERCFT', 'WATERCFT_C', 'WC'), 'PL', IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) IN( 'AGT_ACCT_C', 'BUILD_ADD1', 'H_502', 'PERS_PROP', 'THREE_FAM', 'SPCL_LOSS'), 'XX', 'HO'))))))) AS v_ISO_MODULE,
               DECODE(RTRIM(LTRIM(UNIT_TYPE)), 'DP_3','3', 'HO_3','3', 'HO_4','4', 'HO_5','5', 'HO_6','6', ' ') AS v_ISO_POLICY_FORM_CODE,
               IFF( BCEG IS NULL ,'99', IFF(BCEG = 0,'99', LPAD(TO_CHAR( BCEG :: INT ),2,'0'))) AS ISO_BLDG_CD_EFF_GRAD_CLASS_CD_v,
               IFF(POSITION('COMP',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_COMP_IND,
               IFF(POSITION('ROLL',UPPER(ROOF_TYP)) = 0 AND POSITION('BU',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_ROLL_IND,
               IFF(POSITION('TIL',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_TIL_IND,
               IFF(POSITION('SHA',UPPER(ROOF_TYP)) = 0 AND POSITION('WO',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_SHA_IND,
               IFF(POSITION('META',UPPER(ROOF_TYP)) = 0 AND POSITION('TIN',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_METAL_IND,
               IFF(POSITION('SLA',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_SLATE_IND,
               IFF(POSITION('ASPH',UPPER(ROOF_TYP)) = 0,'N','Y') AS v_ROOF_ASPHALT_IND,
                SUBSTR(V_RPRTG_PERIOD_START_DT,1,4) :: INT  AS v_CURRENT_YR,
               IFF( ROOF_AGE IS NULL OR LTRIM(RTRIM(ROOF_AGE)) = '', v_CURRENT_YR - IFF( YR_BLT IS NULL, v_CURRENT_YR, YR_BLT), IFF(LTRIM(RTRIM(ROOF_AGE)) = 'DATEADD(Years,-5,0)', 5, IFF(LTRIM(RTRIM(ROOF_AGE)) = 'DATEADD(Years,-10,6)', 10, IFF(LTRIM(RTRIM(ROOF_AGE)) = 'DATEADD(Years,-15,11)', 15, IFF(LTRIM(RTRIM(ROOF_AGE)) = 'DATEADD(Years,-20,16)', 20, IFF(LTRIM(RTRIM(ROOF_AGE)) = '21 + Years', 21, v_CURRENT_YR - IFF( YR_BLT IS NULL, v_CURRENT_YR, YR_BLT))))))) AS v_ROOF_AGE_INT,
               v_CURRENT_YR - v_ROOF_AGE_INT AS v_cur_minus_roof_age_yr,
               IFF( v_cur_minus_roof_age_yr IS NULL,'00', (SUBSTR(TO_CHAR(v_cur_minus_roof_age_yr),3,2))) AS v_roof_age_last_2_digits_yr,      TO_DATE('09/01/2024', 'YYYY-MM-DD')       AS V_EFF_DATE,
               TRUNC(V_EFF_DATE,'DD') AS TRUNC_EFF_DT,
               -1 AS BATCH_ID,
               SYSDATE() AS CREATE_DT,
               SYSDATE() AS CREATE_TS,      TO_DATE(V_BATCH_START_DT, 'YYYY-MM-DD')       AS BATCH_START_DT,      TO_DATE(V_BATCH_END_DT, 'YYYY-MM-DD')       AS BATCH_END_DT,      TO_DATE(V_RPRTG_PERIOD_START_DT, 'YYYY-MM-DD')       AS RPRTG_PERIOD_START_DT,      TO_DATE(V_RPRTG_PERIOD_END_DT, 'YYYY-MM-DD')       AS RPRTG_PERIOD_END_DT,
               v_ISO_MODULE AS ISO_MODULE,
               DECODE(RTRIM(LTRIM(CO_CD)),'BHIC', '2700','BHICC', '3536','MWAC','6995','PRAC','5870','BHPIC','3644','BHSIC','3643','BHPFIC','3642') AS ISO_COMPANY_NUMBER,
               '1' AS ISO_TRANSACTION_TYPE_CODE,
               DECODE(SUBSTR(TO_CHAR(TO_DATE(V_RPRTG_PERIOD_END_DT, 'YYYY-MM-DD'),'MMYYYY'),1,2),'01','1','02','2','03','3','04','4','05','5','06','6','07','7','08','8','09','9','10','0','11','-','12','&',' ') || IFF(TO_DATE(V_RPRTG_PERIOD_END_DT, 'YYYY-MM-DD') IS NULL,' ',SUBSTR(TO_CHAR(TO_DATE(V_RPRTG_PERIOD_END_DT, 'YYYY-MM-DD'),'MMYYYY'),6,1)) AS ISO_ACCOUNTING_DATE,
               DECODE(SUBSTR(TO_CHAR(SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT,'MMYYYY'),1,2),'01','1','02','2','03','3','04','4','05','5','06','6','07','7','08','8','09','9','10','0','11','-','12','&',' ') || IFF( SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT IS NULL,'  ',SUBSTR(TO_CHAR(SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT,'MMYYYY'),5,2)) AS ISO_INCEPTION_DATE,
               DECODE(SUBSTR(TO_CHAR(POL_STATE_EFF_DT,'MMYYYY'),1,2),'01','1','02','2','03','3','04','4','05','5','06','6','07','7','08','8','09','9','10','0','11','-','12','&',' ') || IFF( POL_STATE_EFF_DT IS NULL,'  ',SUBSTR(TO_CHAR(POL_STATE_EFF_DT,'MMYYYY'),5,2)) AS ISO_TRANS_EFFECTIVE_DATE,
               DECODE(SUBSTR(TO_CHAR(CUR_TERM_XPTN_DT,'MMYYYY'),1,2),'01','1','02','2','03','3','04','4','05','5','06','6','07','7','08','8','09','9','10','0','11','-','12','&',' ') || IFF( CUR_TERM_XPTN_DT IS NULL,'  ',SUBSTR(TO_CHAR(CUR_TERM_XPTN_DT,'MMYYYY'),5,2)) AS ISO_TRANS_EXPIRATION_DATE,
               Decode (STATE_CODE, 'CT', '06', 'MA','20','NH', '28','  ') AS ISO_STATE_CODE,
               IFF( TERRTY_CD IS NULL,'  ', IFF(RTRIM(STATE_CODE)='CT',DECODE (SUBSTR(RTRIM (TERRTY_CD),2,2),'31','31', '32','32', '33','33', '34','34', '35','35', '36','36', '37','37', '38','38', '39','39', '40','40', '41','41', '42','42', '51','30', '52','30','53','30', '71','31', '74','34', '79','39', '80','40', '  '), IFF(RTRIM(STATE_CODE)='MA',DECODE (SUBSTR(RTRIM(TERRTY_CD),2,2), '02','02', '03','03', '04','04', '05','05', '06','11', '11','11', '12','12', '20','31', '21','31', '22','34', '23','34', '24','36', '25','36', '26','36', '30','30', '32','32', '33','33', '35','35', '37','37', '38','38', '39','39', '40','40', '41','41', '42','42', '43','43', '44','44', '45','45', '46','46', '47','47', '48','48', '49','49', '50','50', '51','37', '52','40', '53','50', '  '),SUBSTR(RTRIM(TERRTY_CD),2,2)))) AS ISO_TERRITORY_CODE,
               IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) = 'PCAT_LIAB' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_DATE('2010-01-01', 'YYYY-MM-DD'), '171', IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) = 'PCAT_LIAB' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT <TO_DATE('2010-01-01', 'YYYY-MM-DD'), '170', IFF(v_ISO_MODULE = 'DF' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_DATE('2010-01-01', 'YYYY-MM-DD'), '040', IFF(v_ISO_MODULE = 'DF' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT <TO_DATE('2010-01-01', 'YYYY-MM-DD'), '010', IFF(v_ISO_MODULE = 'EQ' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_DATE('2010-01-01', 'YYYY-MM-DD'), '040', IFF(v_ISO_MODULE = 'EQ' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT <TO_DATE('2010-01-01', 'YYYY-MM-DD'), '120', IFF(v_ISO_MODULE = 'IM' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_DATE('2010-01-01', 'YYYY-MM-DD'), '040', IFF(v_ISO_MODULE = 'IM' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT <TO_DATE('2010-01-01', 'YYYY-MM-DD'), '090', IFF(v_ISO_MODULE = 'PL' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_DATE('2010-01-01', 'YYYY-MM-DD'), '040', IFF(v_ISO_MODULE = 'PL' 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT <TO_DATE('2010-01-01', 'YYYY-MM-DD'), '170', '040')))))))))) AS ISO_ANNUAL_STMT_LOB_CODE,
               v_ISO_POLICY_FORM_CODE AS ISO_POLICY_FORM_CODE,
               IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) IN( 'Townhouse','Rowhouse') 
               AND NUM_IN_FIRE_DIV = 1,'1', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) IN( 'Townhouse','Rowhouse') 
               AND NUM_IN_FIRE_DIV = 2,'3', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) IN( 'Townhouse','Rowhouse') 
               AND NUM_IN_FIRE_DIV < 5,'2', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) IN( 'Townhouse','Rowhouse') 
               AND NUM_IN_FIRE_DIV > 4,'4', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) NOT IN( 'Townhouse','Rowhouse') 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  = 1, '1', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) NOT IN( 'Townhouse','Rowhouse') 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  = 2, '3', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5') 
               AND RTRIM(LTRIM(STRCT_TYP)) NOT IN( 'Townhouse','Rowhouse') 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  < 5, '6', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_4', 'HO_6') 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  < 5, '1', IFF(RTRIM(LTRIM(UNIT_TYPE)) IN('HO_4', 'HO_6') 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  > 4, '8', IFF(RTRIM(LTRIM(UNIT_TYPE)) = 'DP_3' 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  = 1, '1', IFF(RTRIM(LTRIM(UNIT_TYPE)) = 'DP_3' 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  = 2, '3', IFF(RTRIM(LTRIM(UNIT_TYPE)) = 'DP_3' 
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  < 5, '6', IFF(RTRIM(LTRIM(UNIT_TYPE)) = 'DP_3'
               AND  SUBSTR(NUM_OF_FMLYS,1,2) :: INT  > 4, '8', ' '))))))))))))) AS ISO_NUMBER_OF_FAMILIES_CODE,
              DECODE(RTRIM(LTRIM(CSTRN_TYP)), 'Frame','1', 'Masonry Veneer','2', 'Masonry or Brick Veneer','2', 'Masonry','3', 'Masonry or Brick','3', 'Superior Construction','4', 'Fire Resistive','4', 'Aluminum/Plastic Siding','5', 'Aluminum/Vinyl Siding','5', '1') AS ISO_CONSTRUCTION_CODE,
             IFF(RTRIM(STATE_CODE)='NH',DECODE(RTRIM(FIRE_PTCTN_CLAS),'1','01','2','02','3','03','4','04','5','05','6','06','7','07','8','08','8B','19','9','09','10','69'),
           IFF(RTRIM(STATE_CODE)='MA' OR RTRIM(STATE_CODE)='CT',DECODE(RTRIM(FIRE_PTCTN_CLAS),'1','01','2','02','3','03','4','04','5','05','6','06','7','07','8','08','8B','19','9','09','10','10'))) AS ISO_PROTECTION_CODE,
     
              -- RTRIM(CASE 
              -- WHEN  STATE_CODE='NH' THEN DECODE(RTRIM(FIRE_PTCTN_CLAS),'1','01','2','02','3','03','4','04','5','05','6','06','7','07','8','08','8B','19','9','09','10','69')
                -- RTRIM(CASE 
                --     WHEN STATE_CODE='MA' OR 'CT'  THEN DECODE(RTRIM(FIRE_PTCTN_CLAS),'1','01','2','02','3','03','4','04','5','05','6','06','7','07','8','08','8B','19','9','09','10','10') )
                --  END AS ISO_PROTECTION_CODE,
              IFF( DED_AMT1 IS NULL or DED_AMT1=0,'01', IFF(DED_AMT1>10000,'96', IFF(DED_AMT1>=1 and DED_AMT1<=49,'98', DECODE(DED_AMT1,25,'99',50,'05',100,'10',200,'20',250,'25', 300,'99',350,'99',400,'40',450,'99',500,'50',600,'60',750,'75',800,'80',1000,'82',1200,'84',1500,'85',2000,'87',2500,'88',3000,'89',4000,'90',5000,'91',7500,'92',10000,'93', IFF(DED_AMT1>50 
              and DED_AMT1<10000,'99','  '))))) AS ISO_DEDUCTIBLE_SIZE_CODE,
               IFF( YR_BLT IS NULL,'  ', IFF(RTRIM(UNIT_TYPE) ='HO_4' 
               OR RTRIM(UNIT_TYPE) ='HO_6','  ', IFF( YR_BLT :: INT  <1901, '99', IFF( YR_BLT :: INT  >=1901 
               AND  YR_BLT :: INT  <=1959 , SUBSTR(YR_BLT,3,2), IFF( YR_BLT :: INT  >=1960 
               AND  YR_BLT :: INT  <=1998 , SUBSTR(YR_BLT,3,2), IFF( YR_BLT :: INT  =1999, 'NN', IFF( YR_BLT :: INT  =2000, 'TT', IFF( YR_BLT :: INT  >=2001 
               AND  YR_BLT :: INT  <=2009, 'T' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2010 
               AND  YR_BLT :: INT  <=2019, 'A' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2020
               AND  YR_BLT :: INT  <=2029, 'B' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2030 
               AND  YR_BLT :: INT  <=2039, 'C' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2040 
               AND  YR_BLT :: INT  <=2049, 'D' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2050 
               AND  YR_BLT :: INT  <=2059, 'E' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2060 
               AND  YR_BLT :: INT  <=2069, 'F' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2070 
               AND  YR_BLT :: INT  <=2079, 'G' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2080 
               AND  YR_BLT :: INT  <=2089, 'H' || SUBSTR(YR_BLT,4,1), IFF( YR_BLT :: INT  >=2090 
               AND  YR_BLT :: INT  <=2099, 'I' || SUBSTR(YR_BLT,4,1)))))))))))))))))) AS ISO_YEAR_OF_CONSTRUCTION_CODE,
              IFF(PREMIUM_SOURCE_C IN( 'WATER_BK6UP','WATERBKUP2'),'0005', IFF(LIMIT_AMT1 > 0,LPAD(TO_CHAR(ROUND(LIMIT_AMT1/1000)),4,'0'), '0000')) AS ISO_EXPOSURE,
             IFF(ISO_BLDG_CD_EFF_GRAD_CLASS_CD_v = '00','99', ISO_BLDG_CD_EFF_GRAD_CLASS_CD_v) AS ISO_BLDG_CD_EFF_GRAD_CLASS_CD,
               IFF(STATE_CODE = 'MA' 
               AND TO_CHAR(YR_BLT)>'1978','9', IFF(STATE_CODE = 'MA' 
               AND TO_CHAR(YR_BLT)<'1979','5', IFF(STATE_CODE = 'CT' 
               AND RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5', 'HO_6', 'DP_3') 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_VARCHAR('2011-09-01', 'YYYY-MM-DD') 
               AND (STORM_SHUTTER_FLG = 'N' or STORM_SHUTTER_FLG IS NULL), '8', IFF(STATE_CODE = 'CT' 
               AND RTRIM(LTRIM(UNIT_TYPE)) IN('HO_3', 'HO_5', 'HO_6', 'DP_3') 
               AND SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TO_VARCHAR('2011-09-01', 'YYYY-MM-DD') 
    AND STORM_SHUTTER_FLG = 'Y', '2', ' ')))) AS ISO_STATE_EXCEP_INDIC_CODE_I,'  ' AS ISO_PROTECTIVE_DEVICE_CD, SUBSTR(PSTL_CD,1,5) AS ISO_ZIP_CODE,' ' AS ISO_STATE_EXCEP_INDIC_CODE_II, ' ' AS ISO_STATE_EXCEP_INDIC_CODE_III,
               IFF( LOSS_HISTORY_COUNT IS NULL OR LOSS_HISTORY_COUNT = 0,'0', DECODE (LOSS_HISTORY_COUNT,1,'1',2,'2',3,'3','4')) AS ISO_LOSS_HISTORY_CD,
               '10' AS ISO_COMP_PROG_EXCEP_INDIC,
               '9' AS ISO_STATIS_PLAN_INDIC_CODE,
               PREM_WRIT_M AS ISO_PREMIUM_AMOUNT,
              IFF( POL_NUM IS NULL,'             ',RPAD(SUBSTR(POL_NUM,1,3) || SUBSTR(POL_NUM,5,10),13,' ')) AS ISO_PREMIUM_RECORD_ID,
               IFF( POL_NUM IS NULL,'                    ',RPAD(POL_NUM,20,' ')) AS ISO_POSITIONS_FOR_COMPANY_USE,
               IFF(RTRIM(PREMIUM_SOURCE_C)='EQUAKE','1', IFF(RTRIM(PREMIUM_SOURCE_C)='LOS_ASMEQC','2',' ')) AS ISO_TYPE_OF_EQUAKE_COV,
                IFF(RTRIM(LTRIM(UNIT_TYPE))='HO_3','4',IFF(RTRIM(LTRIM(UNIT_TYPE))='HO_4','2',IFF(RTRIM(LTRIM(UNIT_TYPE))='HO_5','4',IFF(RTRIM(LTRIM(UNIT_TYPE))='DP_3','6',IFF(RTRIM(LTRIM(UNIT_TYPE))='HO_6' 
                AND LTRIM(RTRIM(PREMIUM_SOURCE_C))='COVA','5',IFF(RTRIM(LTRIM(UNIT_TYPE))='HO_6' 
                AND LTRIM(RTRIM(PREMIUM_SOURCE_C))='COVC','3')))))) AS ISO_EQ_ATTACH_INDIC_CODE,
               IFF(RTRIM(LTRIM(PREMIUM_SOURCE_C)) IN( 'EQUAKE', 'LOS_ASMEQC'), LIMIT_AMT1,0) AS ISO_ADD_EQ_EXPOSURE,
                'm_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT' AS CREATED_BY,
                IFF(v_ISO_POLICY_FORM_CODE = '4' OR v_ISO_POLICY_FORM_CODE = '6', ' ', IFF(v_CURRENT_YR - v_ROOF_AGE_INT > 2000, v_roof_age_last_2_digits_yr, IFF(v_CURRENT_YR - v_ROOF_AGE_INT = 2000,'TT', IFF(v_CURRENT_YR - v_ROOF_AGE_INT = 1999,'NN', IFF(v_CURRENT_YR - v_ROOF_AGE_INT >= 1985 
                AND v_CURRENT_YR - v_ROOF_AGE_INT <= 1998, v_roof_age_last_2_digits_yr, '99'))))) AS ISO_ROOF_INSTALL_YR_CD,
                IFF((((v_ISO_POLICY_FORM_CODE = '4') OR (v_ISO_POLICY_FORM_CODE = '6')) 
                AND (SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT >=TRUNC_EFF_DT)), 'T', IFF((((v_ISO_POLICY_FORM_CODE = '4') 
                OR (v_ISO_POLICY_FORM_CODE = '6')) 
                AND (SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.CUR_TERM_EFF_DT < TRUNC_EFF_DT)), ' ', IFF(LTRIM(RTRIM(POOL_CD)) ='AG'
                OR LTRIM(RTRIM(POOL_CD)) = 'IG', IFF( TRMP_FLG IS NULL 
                OR LTRIM(RTRIM(TRMP_FLG)) = '','L', DECODE(TRMP_FLG, 'N','Q', 'Y','R', 'L')), IFF(LTRIM(RTRIM(POOL_CD)) ='NA', IFF( TRMP_FLG IS NULL 
                OR LTRIM(RTRIM(TRMP_FLG)) = '','M', DECODE(TRMP_FLG, 'N','T', 'Y','S', 'M')), IFF( POOL_CD IS NULL 
                OR LTRIM(RTRIM(POOL_CD)) ='', IFF( TRMP_FLG IS NULL 
                OR LTRIM(RTRIM(TRMP_FLG)) = '','U', DECODE(TRMP_FLG, 'N','P', 'Y','N', 'U')) ,'U '))))) AS ISO_RISK_IND_CD,
                IFF(v_ISO_POLICY_FORM_CODE = '4' 
                OR v_ISO_POLICY_FORM_CODE = '6', ' ','3') AS ISO_RISK_IND_CD_II
          FROM SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT
         INNER JOIN EXPTRANS2
            ON SQ_S10_ISO_BURRPT_PLOTA_PREM_EXTRACT.source_record_id = EXPTRANS2.source_record_id
       ) 
       select * from EXPTRANS
       
